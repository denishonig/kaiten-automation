# Использование kaiten-automation через CLI

## Быстрый старт

### 1. Настройка конфигурации

Создайте файл `.env` на основе `config.example.env`:

```bash
cp config.example.env .env
```

Заполните необходимые параметры в `.env`.

### 2. Запуск автоматизации

#### Обработка одной карточки

```bash
python run_automation.py --card-id 12345
```

#### Обработка всех карточек на доске

```bash
python run_automation.py --board-id 123
```

#### Обработка всех карточек в пространстве

```bash
python run_automation.py --space-id 456
```

#### Обработка всех карточек (из конфигурации .env)

```bash
python run_automation.py --all
```

## Полная справка

```bash
python run_automation.py --help
```

## Примеры использования

### Пример 1: Обработка одной карточки

```bash
python run_automation.py --card-id 12345
```

Вывод:
```
✅ Карточка 12345 успешно обработана
```

### Пример 2: Обработка всех карточек на доске

```bash
python run_automation.py --board-id 712508
```

Вывод:
```
Получение списка карточек...
  Фильтр: доска ID 712508

Найдено 15 карточек. Начинаю обработку...

[1/15] Обработка карточки 12345: Доклад о Python...
  ✅ Успешно
[2/15] Обработка карточки 12346: Доклад о Docker...
  ✅ Успешно
...

============================================================
Обработка завершена:
  ✅ Успешно: 15
  ❌ Ошибок: 0
============================================================
```

### Пример 3: Обработка всех карточек в пространстве

```bash
python run_automation.py --space-id 712508
```

### Пример 4: Использование другого файла конфигурации

```bash
python run_automation.py --card-id 12345 --config /path/to/custom.env
```

## Другие полезные утилиты

### Получение информации о карточке

```bash
python get_card_info.py 12345
```

### Получение списка пространств

```bash
python get_card_info.py --spaces
```

### Получение списка досок

```bash
# Все доски
python get_card_info.py --boards

# Доски конкретного пространства
python get_card_info.py --boards --space-id 712508
```

## Что вычисляется автоматизацией

При запуске автоматизации для каждой карточки вычисляются:

1. **Рейтинг Качества** (Золото/Серебро/Бронза)
   - На основе: Актуальность + Новизна + Опыт спикера

2. **Тип Контента** (Хардкор/Массовость/Практический кейс/Вдохновение/Обзор)
   - На основе: Применимость + Массовость

3. **Уровень спикера** (Хедлайнер/Хороший Спикер/Эксперт)
   - На основе: Харизма + IT-инфлюенсер

4. **Охват** (Ниша/Кросс/Для всех)
   - На основе: Массовость

Все вычисленные значения автоматически обновляются в карточке Kaiten.

## Устранение проблем

### Ошибка: "Ошибка конфигурации"

Убедитесь, что:
- Файл `.env` существует и заполнен
- Все обязательные поля указаны (см. `config.example.env`)
- ID полей указаны правильно

### Ошибка: "Ошибка импорта"

Убедитесь, что:
- Файл `index.py` находится в той же директории
- Установлены все зависимости: `pip install -r requirements.txt`

### Ошибка: "Не удалось получить карточку"

Проверьте:
- Правильность ID карточки
- Валидность API токена
- Права доступа к карточке

## Интеграция с cron

Для периодического запуска можно использовать cron:

```bash
# Запуск каждые 5 минут
*/5 * * * * cd /path/to/kaiten-automation && python3 run_automation.py --all >> /var/log/kaiten-automation.log 2>&1
```

## См. также

- [README.md](README.md) - общая документация
- [INTEGRATION_GUIDE.md](INTEGRATION_GUIDE.md) - руководство по интеграции с Yandex Cloud Functions
- [QUICKSTART.md](QUICKSTART.md) - быстрый старт
